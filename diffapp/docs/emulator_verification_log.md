# Android エミュレータ検証履歴

目的: Android エミュレータ上での手動動作確認の記録。再現手順・期待結果・結果を簡潔に残す。

## 事前条件（共通）

- AVD を1つ以上作成済み（Android Studio > Device Manager）
- Flutter 3.22.0（FVM 推奨）
- 依存取得済み: `cd diffapp && fvm flutter pub get`

## 実行コマンド（基本）

- リポジトリ直下から: `pnpm android`
  - `scripts/run_android.sh` 経由で FVM の `flutter` を優先実行
  - 依存取得→エミュレータ起動→`lib/main.dart` 実行まで自動
- 失敗時の手動起動
  - 端末ID確認: `cd diffapp && fvm flutter emulators` / `fvm flutter devices`
  - 実行: `cd diffapp && fvm flutter run -d <emulator-id> --target lib/main.dart`

## 画面での確認ポイント（抜粋）

- ホーム: 「左 の画像を選ぶ」→「サンプルA」で左にプレビュー表示
- 同様に右: 「右 の画像を選ぶ」→「サンプルC」で右にプレビュー表示
- 「けんさせっていへ」で比較（設定）画面へ遷移し、見出し「けんさせってい」
- 「検査をはじめる」で結果画面に遷移し「スクショをとろう！」が表示
- 「再比較」で比較（設定）画面に戻り、「最初からやりなおします」のスナックバーが表示
- 未選択で開始すると「がぞうを えらんでね」スナックバーが表示

---

## 履歴

### 2025-09-18

- 対象変更: ComparePage 再比較時の SnackBar 競合解消（`clearSnackBars()` → 次フレームで `showSnackBar()`）
- 実施者: Agent（自動テストにて確認、手動は開発者に依頼）
- 実行環境: ローカル開発機（macOS 15.6.1）。現時点で Android エミュレータ未検出のため、起動は未実施。
- 期待結果: 結果画面で「再比較」を押すと比較画面に戻り、「最初からやりなおします」スナックバーが確実に表示される。
- 結果: 未（要手動確認）。
- メモ: エミュレータ起動後は本ログへ追記してください（端末ID、成否、スクショの有無など）。

### 2025-09-18（手動確認）

- 対象変更: 範囲指定プレビューの動作確認（指定範囲のみが設定画面に切り出し表示）
- 実施者: 開発者（手動操作）、エージェント（シミュレーター起動とアプリ再起動を実施）
- 端末: Pixel 7 エミュレーター（emulator-5554）
- 実行手順:
  - エージェント: `flutter emulators --launch Pixel_7` で起動 → ADB `sys.boot_completed=1` まで待機
  - 開発者: アプリを起動（`pnpm android` もしくは `fvm flutter run -d emulator-5554 --target lib/main.dart`）
  - 画面操作: ホームで左右画像を選択 → 「けんさせっていへ」→ 範囲指定で矩形を設定
- 期待結果: 指定範囲が「けんさせってい」のプレビューに切り出されて表示される
- 結果: 成功（左/右ともに指定範囲プレビューを確認）
- 備考: 今後は検査（差分抽出）の実装フェーズに移行

---

## 追記テンプレート

```
### YYYY-MM-DD
- 対象変更: <機能/修正>
- 実施者: <名前>
- 端末: <エミュレータ名/ID, APIレベル>
- 実行手順: pnpm android（または run コマンド）
- 期待結果: <簡潔に>
- 結果: 成功/失敗（メモ、スクショパスなど）
```
